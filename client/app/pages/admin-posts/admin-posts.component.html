<div class="space-y-6">
  <div class="bg-text-100 rounded-lg border border-text-200 p-4">
    <div class="flex flex-wrap items-center gap-4">
      <div class="flex-1">
        <r-input type="text" [(ngModel)]="searchQuery" placeholder="搜索文章标题..." class="w-full" />
      </div>

      <select [(ngModel)]="filterStatus"
        class="px-4 py-2 border border-text-300 rounded-lg focus:border-primary-100 focus:ring-1 focus:ring-primary-100 outline-none">
        <option value="">所有状态</option>
        <option value="published">已发布</option>
        <option value="draft">草稿</option>
      </select>

      <r-button [routerLink]="['/admin/posts/new']" type="primary" class="transition-colors">
        新建文章
      </r-button>
    </div>
  </div>

  <div class="bg-text-100 rounded-lg border border-text-200 overflow-y-hidden">
    @if (isLoading) {
    <div class="p-8 text-center">
      <r-loading label="加载中..." />
    </div>
    } @else if (posts.length === 0) {
    <div class="p-8 text-center text-gray-500">
      暂无文章
    </div>
    } @else {
    <table class="min-w-full divide-y divide-text-200 overflow-x-auto">
      <thead class="bg-text-200">
      </thead>
      <tbody class="bg-text-100 divide-y divide-text-200">
        @for (post of pagedPosts; track post.id) {
        <tr class="hover:bg-text-100">
          <td class="px-6 py-4">
            <div class="flex items-center">
              @if (post.banner) {
              <img [src]="post.banner" class="hidden 2xl:inline h-12 object-cover rounded mr-3" alt="Post banner" />
              }
              <div>
                <a target="_blank" [routerLink]="['/post/', post.id]"
                  class="text-sm font-medium text-bg-200 w-sm 2xl:max-w-md truncate">
                  {{ post.title }}
                </a>
                <div class="text-sm text-gray-500">
                  {{ post.created | date:'YYYY-MM-dd HH:mm' }}
                </div>
              </div>
            </div>
          </td>
          <td class="hidden 2xl:inline-block px-6 py-4">
            <p class="text-sm text-gray-500 line-clamp-2">
              {{ post.summary }}
            </p>
          </td>
          <td class="px-6 py-4 text-sm">
            <div class="flex items-center gap-2">
              <r-button [routerLink]="['/admin/edit', post.id]" type="primary">
                编辑
              </r-button>
              <r-button (click)="deletePost(post.id)" type="error">
                删除
              </r-button>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
    }

    @if (pages.length > 1) {
    <div class="px-6 py-4 flex items-center justify-between border-t border-text-300">
      <div class="text-sm text-gray-500">
        共 {{ totalPosts }} 篇文章
      </div>
      <div class="flex items-center gap-2">
        @for (page of pages; track page) {
        @if (currentPage === page) {
        <r-button type="primary">{{ page }}</r-button>
        } @else {
        <r-button (click)="goToPage(page)">
          {{ page }}
        </r-button>
        }
        }
      </div>
    </div>
    }
  </div>
</div>